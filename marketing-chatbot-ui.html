<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Marketing AI Content Pilot</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; }
        
        .topbar {
            height: 60px;
            background: #2c3e50;
            color: white;
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 20px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .topbar h1 { font-size: 18px; }
        
        .data-update {
            font-size: 12px;
            color: #bdc3c7;
        }
        
        .selector-group {
            margin-bottom: 15px;
        }
        
        .selector-group label {
            display: block;
            font-size: 12px;
            color: #2c3e50;
            margin-bottom: 5px;
            font-weight: bold;
        }
        
        .selector-group select {
            width: 100%;
            padding: 10px;
            border: 1px solid #bdc3c7;
            border-radius: 4px;
            font-size: 14px;
        }
        
        .main-container {
            display: flex;
            height: calc(100vh - 60px);
        }
        
        .left-sidebar {
            width: 280px;
            background: #f8f9fa;
            border-right: 1px solid #dee2e6;
            padding: 20px;
            overflow-y: auto;
        }
        
        .right-sidebar {
            width: 300px;
            background: #f8f9fa;
            border-left: 1px solid #dee2e6;
            padding: 20px;
            overflow-y: auto;
        }
        
        .chat-container {
            flex: 1;
            display: flex;
            flex-direction: column;
            background: white;
        }
        
        .purpose-selector {
            padding: 15px 20px;
            background: #ecf0f1;
            border-bottom: 1px solid #bdc3c7;
        }
        
        .purpose-selector select {
            width: 100%;
            padding: 8px;
            border: 1px solid #bdc3c7;
            border-radius: 4px;
            margin-top: 5px;
        }
        
        .chat-messages {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
            background: #fafafa;
        }
        
        .message {
            margin-bottom: 15px;
            max-width: 80%;
        }
        
        .message.user {
            margin-left: auto;
            background: #3498db;
            color: white;
            padding: 10px 15px;
            border-radius: 18px 18px 4px 18px;
        }
        
        .message.bot {
            background: white;
            padding: 15px;
            border-radius: 4px 18px 18px 18px;
            border: 1px solid #e1e8ed;
        }
        
        .chart-container {
            margin: 15px 0;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 8px;
            border: 1px solid #dee2e6;
        }
        
        .chart-title {
            font-weight: bold;
            margin-bottom: 10px;
            color: #2c3e50;
            text-align: left;
        }
        
        .bar-chart {
            display: flex;
            align-items: end;
            height: 150px;
            gap: 10px;
            margin: 10px 0;
            justify-content: flex-start;
        }
        
        .bar {
            background: linear-gradient(to top, #3498db, #5dade2);
            border-radius: 4px 4px 0 0;
            min-width: 40px;
            display: flex;
            flex-direction: column;
            align-items: center;
            position: relative;
        }
        
        .bar-value {
            position: absolute;
            top: -20px;
            font-size: 11px;
            font-weight: bold;
            color: #2c3e50;
        }
        
        .bar-label {
            margin-top: 5px;
            font-size: 10px;
            text-align: center;
            color: #7f8c8d;
        }

        .line-chart-container {
            position: relative;
            height: 160px; /* Â¢ûÂ§ßÈ´òÂ∫¶ */
            margin: 20px 0;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 8px;
            text-align: left;
        }

        .line-chart {
            width: 100%;
            height: 100%;
            position: relative;
        }

        .chart-line {
            fill: none;
            stroke-width: 2;
            stroke-linejoin: round;
            stroke-linecap: round;
        }

        .chart-axis {
            stroke: #bdc3c7;
            stroke-width: 1;
        }

        .chart-label {
            font-size: 11px;
            fill: #34495e; /* Âä†Ê∑±È¢úËâ≤ÊèêÈ´òÂèØËØªÊÄß */
            text-anchor: middle;
        }

        .chart-value-label {
            font-size: 10px;
            fill: #2c3e50; /* Âä†Ê∑±È¢úËâ≤ÊèêÈ´òÂèØËØªÊÄß */
            text-anchor: middle;
            font-weight: bold;
        }

        .chart-title-small {
            font-size: 14px;
            font-weight: bold;
            color: #2c3e50;
            margin-bottom: 10px;
        }

        .chart-legend {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-top: 10px;
            font-size: 10px;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .legend-color {
            width: 12px;
            height: 12px;
            border-radius: 2px;
        }
        
        .metrics-table {
            width: 100%;
            border-collapse: collapse;
            margin: 10px 0;
            font-size: 12px;
        }
        
        .metrics-table th,
        .metrics-table td {
            padding: 8px;
            text-align: left;
            border-bottom: 1px solid #dee2e6;
        }
        
        .metrics-table th {
            background: #f8f9fa;
            font-weight: bold;
            color: #2c3e50;
        }
        
        .insight-box {
            background: #e8f6f3;
            border-left: 4px solid #27ae60;
            padding: 12px;
            margin: 10px 0;
            border-radius: 0 4px 4px 0;
        }
        
        .insight-title {
            font-weight: bold;
            color: #27ae60;
            margin-bottom: 5px;
        }
        
        .chat-input {
            padding: 20px;
            border-top: 1px solid #dee2e6;
            background: white;
        }
        
        .input-group {
            display: flex;
            gap: 10px;
        }
        
        .input-group input {
            flex: 1;
            padding: 12px;
            border: 1px solid #bdc3c7;
            border-radius: 25px;
            outline: none;
        }
        
        .input-group button {
            padding: 12px 20px;
            background: #3498db;
            color: white;
            border: none;
            border-radius: 25px;
            cursor: pointer;
        }
        
        .section {
            margin-bottom: 25px;
        }
        
        .section h3 {
            font-size: 14px;
            color: #2c3e50;
            margin-bottom: 10px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .control-group {
            margin-bottom: 15px;
        }
        
        .control-group label {
            display: block;
            font-size: 12px;
            color: #7f8c8d;
            margin-bottom: 5px;
        }
        
        .control-group select, .control-group input {
            width: 100%;
            padding: 8px;
            border: 1px solid #bdc3c7;
            border-radius: 4px;
            font-size: 14px;
        }
        
        .guidance-questions {
            list-style: none;
        }
        
        .guidance-questions li {
            padding: 8px 12px;
            margin-bottom: 5px;
            background: white;
            border-radius: 4px;
            cursor: pointer;
            font-size: 13px;
            transition: background 0.2s;
        }
        
        .guidance-questions li:hover {
            background: #e8f4fd;
            color: #2980b9;
        }
        
        .metrics-list {
            display: grid;
            gap: 8px;
        }
        
        .metric-item {
            padding: 8px 12px;
            background: white;
            border-radius: 4px;
            font-size: 13px;
            border-left: 3px solid #3498db;
        }
        
        .category-chips {
            display: flex;
            flex-wrap: wrap;
            gap: 5px;
            margin-top: 10px;
        }
        
        .chip {
            padding: 8px 16px;
            background: #e8f4fd;
            color: #2980b9;
            border-radius: 20px;
            font-size: 13px;
            cursor: pointer;
            transition: all 0.2s;
            border: 2px solid transparent;
        }
        
        .chip:hover {
            background: #d4edda;
            transform: translateY(-1px);
        }
        
        .chip.selected {
            background: #3498db;
            color: white;
            border: 2px solid #2980b9;
            box-shadow: 0 2px 4px rgba(52, 152, 219, 0.3);
        }
        
        .voice-of-seller {
            background: #fff3cd;
            border-left: 4px solid #ffc107;
            padding: 12px;
            margin: 10px 0;
            border-radius: 0 4px 4px 0;
        }
        
        .voice-title {
            font-weight: bold;
            color: #856404;
            margin-bottom: 5px;
        }
        
        .metrics-dashboard {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin: 15px 0;
            text-align: left;
        }
        
        .metric-card {
            background: white;
            padding: 15px;
            border-radius: 8px;
            border: 1px solid #dee2e6;
            text-align: center;
        }
        
        .metric-value {
            font-size: 24px;
            font-weight: bold;
            color: #3498db;
        }
        
        .metric-label {
            font-size: 12px;
            color: #7f8c8d;
            margin-top: 5px;
        }
        
        .trend-chart {
            height: 100px;
            display: flex;
            align-items: end;
            gap: 3px;
            margin: 10px 0;
        }

        .trend-point {
            width: 8px;
            background: #3498db;
            border-radius: 4px 4px 0 0;
            position: relative;
            transition: all 0.3s ease;
        }

        .trend-point:hover {
            transform: scaleY(1.1);
            background: #2980b9;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .comparison-badge {
            display: inline-block;
            padding: 2px 6px;
            border-radius: 10px;
            font-size: 10px;
            font-weight: bold;
            margin-left: 5px;
        }
        
        .badge-up {
            background: #d4edda;
            color: #155724;
        }
        
        .badge-down {
            background: #f8d7da;
            color: #721c24;
        }
        
        .pie-chart {
            width: 160px; /* Â¢ûÂ§ßÂ∞∫ÂØ∏ */
            height: 160px;
            border-radius: 50%;
            position: relative;
        }
        
        .pie-center {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: white;
            width: 80px; /* Â¢ûÂ§ß‰∏≠ÂøÉÂúÜ */
            height: 80px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
            font-weight: bold;
            color: #2c3e50;
        }

        .pie-value {
            position: absolute;
            font-size: 11px;
            font-weight: bold;
            color: white;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.5);
        }
        
        .line-chart {
            height: 100px;
            position: relative;
            margin: 10px 0;
        }
        
        .line-path {
            stroke: #3498db;
            stroke-width: 2;
            fill: none;
        }
        
        .welcome-message {
            text-align: center;
            color: #7f8c8d;
            margin-top: 50px;
        }

        /* --- Additions: topbar actions, buttons, floating control, message meta --- */
        .topbar-actions {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .icon-btn {
            background: transparent;
            color: #ecf0f1;
            border: 1px solid rgba(255,255,255,0.15);
            border-radius: 6px;
            padding: 6px 10px;
            cursor: pointer;
            transition: background 0.2s, transform 0.1s;
        }

        .icon-btn:hover { background: rgba(255,255,255,0.1); }
        .icon-btn:active { transform: translateY(1px); }

        .icon-btn.floating {
            position: fixed;
            right: 24px;
            bottom: 92px;
            z-index: 10;
            border: none;
            color: #fff;
            background: #3498db;
            box-shadow: 0 6px 16px rgba(0,0,0,0.15);
            width: 40px;
            height: 40px;
            border-radius: 20px;
            display: none;
        }

        .icon-btn.floating.show { display: inline-flex; align-items: center; justify-content: center; }

        .input-group .secondary {
            background: #eef2f7;
            color: #2c3e50;
            border: 1px solid #cfd8dc;
        }

        .input-group .secondary:hover { background: #e2e8f0; }

        .message-meta {
            display: block;
            font-size: 10px;
            color: #95a5a6;
            margin-top: 6px;
            text-align: right;
        }

        /* Typing indicator */
        .typing {
            background: white;
            padding: 10px 15px;
            border-radius: 4px 18px 18px 18px;
            border: 1px solid #e1e8ed;
            display: inline-flex;
            align-items: center;
            gap: 6px;
        }

        .typing .dot {
            width: 6px;
            height: 6px;
            border-radius: 50%;
            background: #95a5a6;
            animation: pulse 1.2s infinite ease-in-out;
        }

        .typing .dot:nth-child(2) { animation-delay: 0.15s; }
        .typing .dot:nth-child(3) { animation-delay: 0.3s; }

        @keyframes pulse {
            0%, 80%, 100% { transform: scale(0.8); opacity: 0.6; }
            40% { transform: scale(1); opacity: 1; }
        }

        /* Dark theme */
        body.dark { background: #0f1419; color: #e6edf3; }
        body.dark .topbar { background: #111827; box-shadow: 0 2px 4px rgba(0,0,0,0.4); }
        body.dark .data-update { color: #9ca3af; }
        body.dark .left-sidebar, body.dark .right-sidebar { background: #0b1220; border-color: #1f2937; }
        body.dark .chat-container { background: #0f1419; }
        body.dark .purpose-selector { background: #0b1220; border-color: #1f2937; }
        body.dark .chat-messages { background: #0b1220; }
        body.dark .message.bot { background: #111827; border-color: #1f2937; }
        body.dark .message.user { background: #2563eb; }
        body.dark .metrics-table th { background: #0b1220; color: #d1d5db; }
        body.dark .metrics-table td { border-color: #1f2937; color: #d1d5db; }
        body.dark .insight-box { background: #06261f; border-left-color: #10b981; }
        body.dark .voice-of-seller { background: #2a1f00; border-left-color: #f59e0b; }
        body.dark .chip { background: #0b2b4a; color: #93c5fd; }
        body.dark .chip.selected { background: #2563eb; border-color: #1e40af; }
        body.dark .icon-btn { color: #e5e7eb; border-color: rgba(255,255,255,0.2); }
        body.dark .icon-btn:hover { background: rgba(255,255,255,0.08); }
        body.dark .input-group input { background: #0b1220; color: #e5e7eb; border-color: #1f2937; }
        body.dark .input-group .secondary { background: #0b1220; color: #e5e7eb; border-color: #1f2937; }

        /* Compact layout: hide sidebars */
        body.compact-layout .left-sidebar,
        body.compact-layout .right-sidebar { display: none; }
        body.compact-layout .main-container { grid-template-columns: 1fr; }
    </style>
</head>
<body>
    <div class="topbar">
        <h1>Marketing AI Content Pilot</h1>
        <div class="topbar-actions">
            <button class="icon-btn" id="layoutToggle" title="Toggle sidebars" aria-label="Toggle sidebars">‚ò∞</button>
            <button class="icon-btn" id="themeToggle" title="Toggle theme" aria-label="Toggle theme">üåô</button>
            <button class="icon-btn" id="exportChatBtn" title="Export chat" aria-label="Export chat">‚§ì</button>
            <div class="data-update" id="dataUpdate">Data updated: 08/27</div>
        </div>
    </div>

    <div class="main-container">
        <div class="left-sidebar">
            <div class="section">
                <h3>Time Period</h3>
                <div class="control-group">
                    <select id="timePeriod">
                        <option>Last 7 days</option>
                        <option selected>Last 30 days</option>
                        <option>Last 3 months</option>
                        <option>Last 6 months</option>
                        <option>Custom range</option>
                    </select>
                </div>
            </div>

            <div class="section">
                <h3>Quick Questions</h3>
                <ul class="guidance-questions" id="guidanceQuestions">
                    <!-- Questions will be populated by JavaScript -->
                </ul>
            </div>
        </div>

        <div class="chat-container">
            <div class="purpose-selector">
                <div class="selector-group">
                    <label>Channel:</label>
                    <select id="channelSelect">
                        <option value="">Select Channel</option>
                    </select>
                </div>
                
                <div class="selector-group" id="purposeGroup" style="display: none;">
                    <label>Purpose:</label>
                    <select id="purposeSelect">
                        <option value="">Select Purpose</option>
                    </select>
                </div>
                
                <div class="selector-group" id="categoryGroup" style="display: none;">
                    <label>Categories:</label>
                    <div class="category-chips" id="categoryChips"></div>
                </div>
            </div>

            <div class="chat-messages" id="chatMessages">
                <div class="welcome-message">
                    <h3>Welcome to Marketing Analysis Chatbot</h3>
                    <p>Select a channel and purpose to get started, or ask any question about your marketing data.</p>
                </div>
            </div>

            <button id="scrollBottomBtn" class="icon-btn floating" title="Scroll to latest" aria-label="Scroll to latest">‚ñº</button>

            <div class="chat-input">
                <div class="input-group">
                    <input type="text" id="messageInput" placeholder="Ask about your marketing performance..." aria-label="Message input">
                    <button class="secondary" id="clearChatBtn" title="Clear conversation" aria-label="Clear conversation">Clear</button>
                    <button onclick="sendMessage()" aria-label="Send message">Send</button>
                </div>
            </div>
        </div>

        <div class="right-sidebar">
            <div class="section">
                <h3>Available Metrics</h3>
                <div class="metrics-list" id="metricsList">
                    <!-- Metrics will be populated by JavaScript -->
                </div>
            </div>

            <div class="section">
                <h3>Voice of Seller</h3>
                <div class="voice-of-seller" id="voiceOfSeller">
                    <div class="voice-title">üó£Ô∏è Recent Feedback</div>
                    <div style="font-size: 11px; line-height: 1.3;">
                        "Â∏åÊúõËÉΩÁúãÂà∞Êõ¥Â§öÈÄâÂìÅÂ∑•ÂÖ∑ÊïôÁ®ã"<br>
                        "Áâ©ÊµÅÊàêÊú¨ÂàÜÊûêÂæàÂÆûÁî®"<br>
                        "ÈúÄË¶ÅÊõ¥Â§öÂêàËßÑÊåáÂØº"
                    </div>
                </div>
            </div>
            
            <div class="section">
                <h3>Analysis Features</h3>
                <div style="font-size: 12px; color: #7f8c8d; line-height: 1.4;">
                    ‚Ä¢ Hot Topics Analysis<br>
                    ‚Ä¢ Voice of Seller Insights<br>
                    ‚Ä¢ Top 3 Content Titles<br>
                    ‚Ä¢ Cross-channel Comparison<br>
                    ‚Ä¢ Performance Trends<br>
                    ‚Ä¢ Custom Chart Generation
                </div>
            </div>
        </div>
    </div>

    <script>
        // Load configuration and initialize UI
        const config = {
            "channels": [
                {"id": "wechat", "name": "ÂæÆ‰ø°ËÆ¢ÈòÖÂè∑", "purposes": ["branding", "lead_gen", "seller_success", "survey"]},
                {"id": "wechat_video", "name": "ÂæÆ‰ø°ËßÜÈ¢ëÂè∑", "purposes": ["branding", "lead_gen", "seller_success", "survey"]},
                {"id": "vhall_live", "name": "Áõ¥Êí≠", "purposes": ["branding", "lead_gen", "seller_success", "survey"]},
                {"id": "douyin_video", "name": "ÊäñÈü≥", "purposes": ["branding", "lead_gen", "seller_success", "survey"]},
                {"id": "rednote", "name": "Â∞èÁ∫¢‰π¶", "purposes": ["branding", "lead_gen", "seller_success", "survey"]},
                {"id": "email", "name": "ÈÇÆ‰ª∂Ëê•ÈîÄ", "purposes": ["branding", "lead_gen", "seller_success", "survey"]}
            ],
            "purpose_categories": {
                "branding": ["branding", "event", "seller_segmentation", "marketplace"],
                "seller_success": ["seller_education", "amazon_business", "supply_chain", "traffic_and_conversion", "brand_own_tools", "compliance", "SPN", "paid_service"],
                "survey": ["survey"],
                "lead_gen": ["marketplace", "lead_or_registration_start_to_launch"]
            },
            "metrics": ["impressions", "page_views", "unique_visitors", "open_rate", "cta_clicks", "cta_rate"],
            "guidance_questions": [
                "ËØ∑ÊâæÂá∫ËøáÂéª‰∏â‰∏™ÊúàÂú®ÂæÆ‰ø°Ê∏†ÈÅìÂåóÁæéÂ∏ÇÂú∫ÈáåÂÖ≥‰∫éSelectionÂÆåËØªÁéáÊúÄÈ´òÁöÑ5ÁØáÊñáÁ´†„ÄÇÂàÜÊûê‰ªñ‰ª¨ÁöÑÁî®Êà∑ÂèçÈ¶àÊúâÂì™‰∫õ„ÄÇ",
                "ÊØîËæÉ‰∏Ä‰∏ãAds domainÂú®ÂæÆ‰ø°ËÆ¢ÈòÖÂè∑ÈáåÂπ≥ÂùáÊâìÂºÄÁéáÂ∑ÆÂºÇ„ÄÇ Âì™‰∫õÊòØÂéÜÂè≤Top 10Âíå Last 10 CTR ÊñáÁ´†„ÄÇ ÊÄªÁªìÂéüÂõ†„ÄÇ",
                "‰∏ä‰∏™Êúà‰æõÂ∫îÈìæcategoryÂú®Áõ¥Êí≠channelÂèëË°®ËøáÁöÑÊâÄÊúâÁ≥ªÂàóÁõ¥Êí≠ÈáåÔºåÂçñÂÆ∂ÂèçÈ¶àÊúÄÂ•ΩÁöÑ5‰∏™‰∏ªÈ¢òÂíåÊúÄÂÖ≥ÂøÉÁöÑ10‰∏™ÈóÆÈ¢òÊòØ‰ªÄ‰πàÔºü",
                "Compliance category‰∏ãÔºåÂì™‰∫õpromotionalÁ±ªÂûãÁöÑÈÇÆ‰ª∂Ê†áÈ¢òÊòØÊâìÂºÄÁéáÊõ¥È´ò„ÄÅÊõ¥ÂèóÂçñÂÆ∂ÂñúÊ¨¢ÁöÑÔºü",
                "ÊàëÊÉ≥Âèë‰∏ÄÁØáÂÖ≥‰∫éÈÄâÂìÅË∂ãÂäøÁöÑÂæÆ‰ø°ÊñáÁ´†ÔºåËØ∑Âü∫‰∫éÂéÜÂè≤Ë°®Áé∞ÔºåÁªôÊàë‰∏Ä‰∫õÂª∫ËÆÆ„ÄÇ",
                "ËØ∑ÁªìÂêàÂéÜÂè≤Êï∞ÊçÆÔºåÂ∏ÆÊàëÂàÜÊûêËøô‰∏™Ê†áÈ¢òÂú®ÂæÆ‰ø°Ê∏†ÈÅì/EmailÊ∏†ÈÅì/Â∞èÁ∫¢‰π¶Á≠âCTRË°®Áé∞È¢ÑËÆ°Â¶Ç‰ΩïÔºüÊ†áÈ¢ò: 'xxx'"
            ]
        };

        let currentChannel = null;
        let currentPurpose = null;
        let selectedCategories = [];
        let currentTimePeriod = 'Last 30 days';
        
        // Voice of Seller data based on selections
        const voiceOfSellerData = {
            "wechat": {
                "branding": {
                    "branding": [
                        {text: "ÂçñÂÆ∂ÁàÜ‰∏çÁàÜÂçï‰∏çÊ∏ÖÊ•ö ‰∫öÈ©¨ÈÄäÁàÜÂçï‰∏çËÄêËØØ", sentiment: "negative", category: "branding"},
                        {text: "ÂìÅÁâåÊïÖ‰∫ãÂæàÊÑü‰∫∫ÔºåÂª∫ËÆÆÂ¢ûÂä†ËßÜÈ¢ëÂÜÖÂÆπ", sentiment: "positive", category: "branding"},
                        {text: "ÈÇ£Êó•Êú¨Á´ô‰ºö‰∏äÁ∫øËøô‰∏™ÂäüËÉΩÂêóÔºü", sentiment: "neutral", category: "branding"}
                    ],
                    "event": [
                        {text: "Ê¥ªÂä®È¢ÑÂëäÂæàÂèäÊó∂Ôºå‰ΩÜÊä•ÂêçÊµÅÁ®ãÂèØ‰ª•ÁÆÄÂåñ", sentiment: "neutral", category: "event"},
                        {text: "‰∫öÈ©¨ÈÄäÁöÑÊ¥ªÂä®‰ªÄ‰πàÊó∂ÂÄôËÉΩË¶ÜÁõñÊ¨ßÊ¥≤Á´ôÔºü", sentiment: "neutral", category: "event"},
                        {text: "Ê¥ªÂä®ÂêéÁª≠Ë∑üËøõÂÅöÂæóÂæàÂ•Ω", sentiment: "positive", category: "event"}
                    ],
                    "seller_segmentation": [
                        {text: "ÂçñÂÆ∂ÂàÜÁ±ªÂ§™Á≤óÁ≥ôÔºåÂ∏åÊúõÊõ¥Á≤æÁªÜ", sentiment: "negative", category: "seller_segmentation"},
                        {text: "‰∏≠Â∞èÂçñÂÆ∂ÁöÑÈúÄÊ±Ç‰∏ç‰∏ÄÊ†∑", sentiment: "neutral", category: "seller_segmentation"},
                        {text: "ËÉΩ‰∏çËÉΩÊåâË°å‰∏öÂàÜÁ±ªÔºü", sentiment: "neutral", category: "seller_segmentation"}
                    ],
                    "marketplace": [
                        {text: "Â∏ÇÂú∫‰ø°ÊÅØÂæàÊúâÁî®Ôºå‰ΩÜÊõ¥Êñ∞‰∏çÂ§üÂèäÊó∂", sentiment: "neutral", category: "marketplace"},
                        {text: "Á´ûÂìÅÂàÜÊûêÂæàÊ£í", sentiment: "positive", category: "marketplace"},
                        {text: "‰ªÄ‰πàÊó∂ÂÄôÊúâ‰∏úÂçó‰∫öÂ∏ÇÂú∫Êï∞ÊçÆÔºü", sentiment: "neutral", category: "marketplace"}
                    ]
                },
                "seller_success": {
                    "seller_education": [
                        {text: "ÊïôËÇ≤ÂÜÖÂÆπÂæàÂÆûÁî®Ôºå‰ΩÜÊòØËÉΩ‰∏çËÉΩÊõ¥Êñ∞Âø´‰∏ÄÁÇπ", sentiment: "neutral", category: "seller_education"},
                        {text: "Êñ∞ÊâãÊåáÂØºÂæàËØ¶ÁªÜÔºåÂª∫ËÆÆÂ¢ûÂä†ËßÜÈ¢ëÊïôÁ®ã", sentiment: "positive", category: "seller_education"},
                        {text: "Ëøô‰∏™ÊîøÁ≠ñÂØπ‰∏≠ÂõΩÂçñÂÆ∂Êúâ‰ªÄ‰πàÂΩ±ÂìçÔºü", sentiment: "neutral", category: "seller_education"}
                    ],
                    "amazon_business": [
                        {text: "‰∫öÈ©¨ÈÄäB2B‰∏öÂä°‰ªÄ‰πàÊó∂ÂÄôÂú®‰∏≠ÂõΩ‰∏äÁ∫øÔºü", sentiment: "neutral", category: "amazon_business"},
                        {text: "‰ºÅ‰∏öÈááË¥≠ÁöÑÈó®ÊßõÂ§™È´ò‰∫Ü", sentiment: "negative", category: "amazon_business"},
                        {text: "ËÉΩ‰∏çËÉΩÁÆÄÂåñËÆ§ËØÅÊµÅÁ®ãÔºü", sentiment: "neutral", category: "amazon_business"}
                    ],
                    "supply_chain": [
                        {text: "‰æõÂ∫îÈìæÊàêÊú¨Ë∂äÊù•Ë∂äÈ´ò‰∫Ü", sentiment: "negative", category: "supply_chain"},
                        {text: "Áâ©ÊµÅÊó∂ÊïàËÉΩ‰∏çËÉΩÂÜçÂø´‰∏ÄÁÇπÔºü", sentiment: "neutral", category: "supply_chain"},
                        {text: "‰ªÄ‰πàÊó∂ÂÄôÊúâ‰∏≠Ê¨ßÁè≠ÂàóÁöÑÁâ©ÊµÅÊñπÊ°àÔºü", sentiment: "neutral", category: "supply_chain"}
                    ],
                    "traffic_and_conversion": [
                        {text: "ÊµÅÈáèÂàÜÊûêÂæà‰∏ì‰∏öÔºå‰ΩÜÊúØËØ≠Â§™Â§ö", sentiment: "neutral", category: "traffic_and_conversion"},
                        {text: "ËΩ¨ÂåñÁéá‰ºòÂåñÂª∫ËÆÆÂæàÊúâÊïà", sentiment: "positive", category: "traffic_and_conversion"},
                        {text: "‰∏∫‰ªÄ‰πàÊàëÁöÑÂπøÂëäË¥πÁî®Ë∂äÊù•Ë∂äÈ´òÔºü", sentiment: "negative", category: "traffic_and_conversion"}
                    ],
                    "brand_own_tools": [
                        {text: "ÂìÅÁâåÂ∑•ÂÖ∑Â§™Â§çÊùÇ‰∫ÜÔºåËÉΩÁÆÄÂåñÂêóÔºü", sentiment: "negative", category: "brand_own_tools"},
                        {text: "ÂìÅÁâåÂ§áÊ°àË¶ÅÂ§ö‰πÖÔºü", sentiment: "neutral", category: "brand_own_tools"},
                        {text: "‰∏∫‰ªÄ‰πàÊàëÁöÑÂìÅÁâåÁî≥ËØ∑Ë¢´Êãí‰∫ÜÔºü", sentiment: "negative", category: "brand_own_tools"}
                    ],
                    "compliance": [
                        {text: "ÂêàËßÑË¶ÅÊ±ÇË∂äÊù•Ë∂ä‰∏•Ê†º‰∫Ü", sentiment: "negative", category: "compliance"},
                        {text: "ÊîøÁ≠ñÊõ¥Êñ∞Â§™È¢ëÁπÅÔºåË∑ü‰∏ç‰∏ä", sentiment: "negative", category: "compliance"},
                        {text: "Ê¨ßÁõüÁöÑÊñ∞ËßÑÂÆöÂΩ±ÂìçÂ§ßÂêóÔºü", sentiment: "neutral", category: "compliance"}
                    ],
                    "SPN": [
                        {text: "ÊúçÂä°ÂïÜÁΩëÁªúÁöÑË¥®ÈáèÂèÇÂ∑Æ‰∏çÈΩê", sentiment: "negative", category: "SPN"},
                        {text: "ÊÄé‰πàÈÄâÊã©Èù†Ë∞±ÁöÑÊúçÂä°ÂïÜÔºü", sentiment: "neutral", category: "SPN"},
                        {text: "ÊúçÂä°ÂïÜÁöÑË¥πÁî®ËÉΩÈÄèÊòé‰∏ÄÁÇπÂêóÔºü", sentiment: "neutral", category: "SPN"}
                    ],
                    "paid_service": [
                        {text: "‰ªòË¥πÊúçÂä°ÁöÑÊïàÊûúÊÄé‰πàÊ†∑Ôºü", sentiment: "neutral", category: "paid_service"},
                        {text: "‰ª∑Ê†ºÂ§™Ë¥µ‰∫ÜÔºåÊúâ‰ºòÊÉ†ÂêóÔºü", sentiment: "negative", category: "paid_service"},
                        {text: "ËÉΩ‰∏çËÉΩÂÖàËØïÁî®ÂÜç‰ªòË¥πÔºü", sentiment: "neutral", category: "paid_service"}
                    ]
                },
                "survey": {
                    "survey": [
                        {text: "Ë∞ÉÁ†îÈóÆÂç∑Â§™Èïø‰∫ÜÔºåËÉΩÁÆÄÂåñÂêóÔºü", sentiment: "negative", category: "survey"},
                        {text: "Â°´ÂÆåÈóÆÂç∑Êúâ‰ªÄ‰πàÂ•ñÂä±Ôºü", sentiment: "neutral", category: "survey"},
                        {text: "‰ªÄ‰πàÊó∂ÂÄôËÉΩÁúãÂà∞Ë∞ÉÁ†îÁªìÊûúÔºü", sentiment: "neutral", category: "survey"}
                    ]
                },
                "lead_gen": {
                    "marketplace": [
                        {text: "Â∏ÇÂú∫‰ø°ÊÅØÂæàÊúâÁî®Ôºå‰ΩÜÊõ¥Êñ∞‰∏çÂ§üÂèäÊó∂", sentiment: "neutral", category: "marketplace"},
                        {text: "Á´ûÂìÅÂàÜÊûêÂæàÊ£í", sentiment: "positive", category: "marketplace"},
                        {text: "‰ªÄ‰πàÊó∂ÂÄôÊúâ‰∏úÂçó‰∫öÂ∏ÇÂú∫Êï∞ÊçÆÔºü", sentiment: "neutral", category: "marketplace"}
                    ],
                    "lead_or_registration_start_to_launch": [
                        {text: "Ê≥®ÂÜåÊµÅÁ®ãÂ§™Â§çÊùÇ‰∫Ü", sentiment: "negative", category: "lead_gen"},
                        {text: "ËÉΩ‰∏çËÉΩÊîØÊåÅÂæÆ‰ø°ÁôªÂΩïÔºü", sentiment: "neutral", category: "lead_gen"},
                        {text: "Êñ∞ÊâãÂºïÂØºÂÅöÂæó‰∏çÈîô", sentiment: "positive", category: "lead_gen"}
                    ]
                }
            },
            "email": {
                "branding": {
                    "branding": [
                        {text: "ÈÇÆ‰ª∂ËÆæËÆ°Âæà‰∏ì‰∏öÔºå‰ΩÜÊâìÂºÄÁéáËøòÈúÄÊèêÂçá", sentiment: "neutral", category: "branding"},
                        {text: "ÂìÅÁâå‰∏ÄËá¥ÊÄßÂÅöÂæóÂæàÂ•Ω", sentiment: "positive", category: "branding"},
                        {text: "‰∏∫‰ªÄ‰πàÊàëÁöÑÈÇÆ‰ª∂ÊÄªÊòØËøõÂûÉÂúæÁÆ±Ôºü", sentiment: "negative", category: "branding"}
                    ],
                    "marketplace": [
                        {text: "Â∏ÇÂú∫ÂàÜÊûêÊä•ÂëäÂæàÊúâ‰ª∑ÂÄº", sentiment: "positive", category: "marketplace"},
                        {text: "Á´ûÂìÅÂØπÊØîÂæàËØ¶ÁªÜÔºåÂæàÊúâÂèÇËÄÉÊÑè‰πâ", sentiment: "positive", category: "marketplace"},
                        {text: "Ëøô‰∏™Êï∞ÊçÆÊòØÂÆûÊó∂ÁöÑÂêóÔºü", sentiment: "neutral", category: "marketplace"}
                    ]
                },
                "lead_gen": {
                    "lead_or_registration_start_to_launch": [
                        {text: "Ê≥®ÂÜåÊµÅÁ®ãÂæàÁÆÄÂçïÔºåËΩ¨ÂåñÁéá‰∏çÈîô", sentiment: "positive", category: "lead_gen"},
                        {text: "ÂºïÂØºÂÜÖÂÆπÂæàÂê∏Âºï‰∫∫", sentiment: "positive", category: "lead_gen"},
                        {text: "‰ªÄ‰πàÊó∂ÂÄôËÉΩÊîØÊåÅ‰∏≠ÊñáÁïåÈù¢Ôºü", sentiment: "neutral", category: "lead_gen"}
                    ]
                }
            },
            "vhall_live": {
                "seller_success": {
                    "supply_chain": [
                        {text: "‰æõÂ∫îÈìæÁõ¥Êí≠ÂæàÂÆûÁî®ÔºåËß£ÂÜ≥‰∫ÜÂæàÂ§öÂÆûÈôÖÈóÆÈ¢ò", sentiment: "positive", category: "supply_chain"},
                        {text: "‰∏ìÂÆ∂ÂàÜ‰∫´Âæà‰∏ì‰∏öÔºåÂ∏åÊúõËÉΩÊúâÊõ¥Â§ö‰∫íÂä®", sentiment: "positive", category: "supply_chain"},
                        {text: "Ëøô‰∏™ÊñπÊ°àÈÄÇÁî®‰∫éÂ∞èÂçñÂÆ∂ÂêóÔºü", sentiment: "neutral", category: "supply_chain"}
                    ],
                    "compliance": [
                        {text: "ÂêàËßÑÊåáÂØºÂæàÂèäÊó∂ÔºåÈÅøÂÖç‰∫ÜÂæàÂ§öÂùë", sentiment: "positive", category: "compliance"},
                        {text: "ÊîøÁ≠ñËß£ËØªÂæàÊ∏ÖÊô∞", sentiment: "positive", category: "compliance"},
                        {text: "Ê¨ßÊ¥≤Á´ôÁöÑÂêàËßÑË¶ÅÊ±ÇÂíåÁæéÂõΩÁ´ô‰∏ÄÊ†∑ÂêóÔºü", sentiment: "neutral", category: "compliance"}
                    ]
                }
            },
            "rednote": {
                "branding": {
                    "branding": [
                        {text: "Â∞èÁ∫¢‰π¶ÂÜÖÂÆπÂæàÊúâÂàõÊÑèÔºå‰∫íÂä®ÁéáÂæàÈ´ò", sentiment: "positive", category: "branding"},
                        {text: "ÂõæÁâáË¥®ÈáèÂæàÂ•ΩÔºåÂæàÂê∏ÂºïÁúºÁêÉ", sentiment: "positive", category: "branding"},
                        {text: "‰∫öÈ©¨ÈÄä‰ªÄ‰πàÊó∂ÂÄôÂú®Â∞èÁ∫¢‰π¶ÂºÄÂ∫óÔºü", sentiment: "neutral", category: "branding"}
                    ],
                    "event": [
                        {text: "Ê¥ªÂä®Âú®Â∞èÁ∫¢‰π¶‰∏ä‰º†Êí≠ÂæàÂø´", sentiment: "positive", category: "event"},
                        {text: "Áî®Êà∑ÂèÇ‰∏éÂ∫¶ÂæàÈ´ò", sentiment: "positive", category: "event"},
                        {text: "Ëøô‰∏™Ê¥ªÂä®ÂèØ‰ª•ÂíåÊäñÈü≥ËÅîÂä®ÂêóÔºü", sentiment: "neutral", category: "event"}
                    ]
                }
            },
            "douyin_video": {
                "branding": {
                    "branding": [
                        {text: "ÊäñÈü≥ÁöÑËßÜÈ¢ëÊïàÊûúÂæàÊ£íÔºå‰ΩÜÊòØÊàêÊú¨Â§™È´ò", sentiment: "neutral", category: "branding"},
                        {text: "Áü≠ËßÜÈ¢ëÁöÑ‰º†Êí≠ÊïàÊûúÁ°ÆÂÆûÂ•Ω", sentiment: "positive", category: "branding"},
                        {text: "‰∫öÈ©¨ÈÄä‰ªÄ‰πàÊó∂ÂÄôÂú®ÊäñÈü≥ÂºÄÁõ¥Êí≠Ôºü", sentiment: "neutral", category: "branding"}
                    ],
                    "event": [
                        {text: "Ê¥ªÂä®Âú®ÊäñÈü≥‰∏äÊõùÂÖâÈáèÂæàÈ´ò", sentiment: "positive", category: "event"},
                        {text: "Áî®Êà∑ÂèÇ‰∏éÂ∫¶ÊØîÂÖ∂‰ªñÂπ≥Âè∞Â•Ω", sentiment: "positive", category: "event"},
                        {text: "Ëøô‰∏™Ê¥ªÂä®ËÉΩÂíåÂæÆ‰ø°ÂêåÊ≠•ÂêóÔºü", sentiment: "neutral", category: "event"}
                    ]
                }
            },
            "wechat_video": {
                "branding": {
                    "branding": [
                        {text: "ÂæÆ‰ø°ËßÜÈ¢ëÂè∑ÁöÑÂÜÖÂÆπË¥®ÈáèÂæàÈ´ò", sentiment: "positive", category: "branding"},
                        {text: "ËßÜÈ¢ëÂà∂‰ΩúÊàêÊú¨ÊØîÂõæÊñáÈ´òÂæàÂ§ö", sentiment: "neutral", category: "branding"},
                        {text: "‰∫öÈ©¨ÈÄäÁöÑËßÜÈ¢ëÂè∑‰ªÄ‰πàÊó∂ÂÄôÊõ¥Êñ∞Ôºü", sentiment: "neutral", category: "branding"}
                    ],
                    "event": [
                        {text: "ËßÜÈ¢ëÊ¥ªÂä®ÁöÑ‰º†Êí≠ÊïàÊûúÂæàÂ•Ω", sentiment: "positive", category: "event"},
                        {text: "Áî®Êà∑ÁïôÂ≠òÁéáÊØîÂÖ∂‰ªñÂπ≥Âè∞È´ò", sentiment: "positive", category: "event"},
                        {text: "Ëøô‰∏™Ê¥ªÂä®ËÉΩÂÅöÊàêÁ≥ªÂàóÂêóÔºü", sentiment: "neutral", category: "event"}
                    ]
                }
            }
        };
        
        // Voice of Seller insights
        const voiceInsights = {
            "wechat": "ÂæÆ‰ø°Áî®Êà∑Êõ¥ÂÅèÂ•ΩÊ∑±Â∫¶ÂÜÖÂÆπÂíåÊïôËÇ≤ÊÄßÊñáÁ´†ÔºåÂπ≥ÂùáÈòÖËØªÊó∂ÈïøÊØîÂÖ∂‰ªñÂπ≥Âè∞È´ò40%",
            "email": "ÈÇÆ‰ª∂Áî®Êà∑ÂØπÊï∞ÊçÆÂàÜÊûêÂíåÊä•ÂëäÁ±ªÂÜÖÂÆπÂìçÂ∫îÊúÄÂ•ΩÔºå‰∏ì‰∏öÊÄßË¶ÅÊ±ÇËæÉÈ´ò",
            "vhall_live": "Áõ¥Êí≠Áî®Êà∑ÊúÄÂÖ≥Ê≥®ÂÆûÊìçÊÄßÂÜÖÂÆπÔºåÈóÆÁ≠îÁéØËäÇÂèÇ‰∏éÂ∫¶ÊòØÊôÆÈÄöÂÜÖÂÆπÁöÑ3ÂÄç",
            "rednote": "Â∞èÁ∫¢‰π¶Áî®Êà∑ÂñúÊ¨¢ËßÜËßâÂåñÂÜÖÂÆπÔºåÂõæÊñáÂπ∂ËåÇÁöÑÂ∏ñÂ≠ê‰∫íÂä®ÁéáÊèêÂçá60%",
            "douyin_video": "ÊäñÈü≥Áî®Êà∑Ê≥®ÊÑèÂäõÈõÜ‰∏≠Êó∂Èó¥Áü≠ÔºåÂâç3ÁßíÂÜ≥ÂÆöÊòØÂê¶ÁªßÁª≠ËßÇÁúã",
            "wechat_video": "ÂæÆ‰ø°ËßÜÈ¢ëÂè∑Áî®Êà∑Êõ¥‰ø°‰ªªÁÜü‰∫∫Êé®ËçêÔºåËΩ¨ÂèëÁéáÊØîÂÖ∂‰ªñÂπ≥Âè∞È´ò25%"
        };

        // Initialize UI
        function initializeUI() {
            populateChannels();
            populateMetrics();
            populateGuidanceQuestions();
        }

        function populateChannels() {
            const selector = document.getElementById('channelSelect');
            config.channels.forEach(channel => {
                const option = document.createElement('option');
                option.value = channel.id;
                option.textContent = channel.name;
                selector.appendChild(option);
            });
        }

        function populateMetrics() {
            const metricsList = document.getElementById('metricsList');
            config.metrics.forEach(metric => {
                const div = document.createElement('div');
                div.className = 'metric-item';
                div.textContent = metric.replace('_', ' ').toUpperCase();
                metricsList.appendChild(div);
            });
        }

        function populateGuidanceQuestions() {
            const questionsList = document.getElementById('guidanceQuestions');
            config.guidance_questions.forEach(question => {
                const li = document.createElement('li');
                li.textContent = question;
                li.onclick = () => askQuestion(question);
                questionsList.appendChild(li);
            });
        }

        function selectChannel() {
            const channelId = document.getElementById('channelSelect').value;
            if (!channelId) {
                document.getElementById('purposeGroup').style.display = 'none';
                document.getElementById('categoryGroup').style.display = 'none';
                updateVoiceOfSeller();
                return;
            }
            
            currentChannel = config.channels.find(c => c.id === channelId);
            
            // Show purpose selector
            document.getElementById('purposeGroup').style.display = 'block';
            
            // Populate purposes
            const purposeSelect = document.getElementById('purposeSelect');
            purposeSelect.innerHTML = '<option value="">Select Purpose</option>';
            currentChannel.purposes.forEach(purpose => {
                const option = document.createElement('option');
                option.value = purpose;
                option.textContent = purpose.replace('_', ' ').toUpperCase();
                purposeSelect.appendChild(option);
            });
            
            updateVoiceOfSeller();
            addMessage(`Â∑≤ÈÄâÊã©Ê∏†ÈÅì: ${currentChannel.name}. ËØ∑ÈÄâÊã©Ëê•ÈîÄÁõÆÁöÑÁªßÁª≠„ÄÇ`, 'bot');
        }

        function updateCategories() {
            const purpose = document.getElementById('purposeSelect').value;
            const chipsContainer = document.getElementById('categoryChips');
            chipsContainer.innerHTML = '';
            selectedCategories = [];
            
            if (!purpose) {
                document.getElementById('categoryGroup').style.display = 'none';
                currentPurpose = null;
                updateVoiceOfSeller();
                return;
            }
            
            currentPurpose = purpose;
            document.getElementById('categoryGroup').style.display = 'block';
            
            if (config.purpose_categories[purpose]) {
                config.purpose_categories[purpose].forEach(category => {
                    const chip = document.createElement('div');
                    chip.className = 'chip';
                    chip.textContent = category.replace('_', ' ');
                    chip.onclick = () => toggleCategory(chip, category);
                    chipsContainer.appendChild(chip);
                });
            }
            
            updateVoiceOfSeller();
        }

        function toggleCategory(chipElement, category) {
                    chipElement.classList.toggle('selected');
                    if (selectedCategories.includes(category)) {
                        selectedCategories = selectedCategories.filter(c => c !== category);
                    } else {
                        selectedCategories.push(category);
                    }

                    updateVoiceOfSeller();

                    // Show metrics dashboard when category is selected
                    if (selectedCategories.length > 0) {
                        showMetricsDashboard();
                    }
                }

        function showMetricsDashboard() {
            const voiceFeedback = getContextualVoiceFeedback();
            const comparisonPeriod = getComparisonPeriod();
            const metrics = getCategoryMetrics();
            const barData = getCategoryBarData();

            const dashboard = `
                <div class="metrics-dashboard">
                    <div class="metric-card">
                        <div class="metric-value">${metrics.ctr}% <span class="comparison-badge ${metrics.ctrTrend > 0 ? 'badge-up' : 'badge-down'}">${metrics.ctrTrend > 0 ? '‚Üë' : '‚Üì'} ${Math.abs(metrics.ctrTrend)}%</span></div>
                        <div class="metric-label">Âπ≥ÂùáCTR (vs ${comparisonPeriod})</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-value">${metrics.impressions} <span class="comparison-badge ${metrics.impressionsTrend > 0 ? 'badge-up' : 'badge-down'}">${metrics.impressionsTrend > 0 ? '‚Üë' : '‚Üì'} ${Math.abs(metrics.impressionsTrend)}%</span></div>
                        <div class="metric-label">ÊÄªÊõùÂÖâÈáè (vs ${comparisonPeriod})</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-value">${metrics.openRate}% <span class="comparison-badge ${metrics.openRateTrend > 0 ? 'badge-up' : 'badge-down'}">${metrics.openRateTrend > 0 ? '‚Üë' : '‚Üì'} ${Math.abs(metrics.openRateTrend)}%</span></div>
                        <div class="metric-label">ÊâìÂºÄÁéá (vs ${comparisonPeriod})</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-value">${metrics.visitors} <span class="comparison-badge ${metrics.visitorsTrend > 0 ? 'badge-up' : 'badge-down'}">${metrics.visitorsTrend > 0 ? '‚Üë' : '‚Üì'} ${Math.abs(metrics.visitorsTrend)}%</span></div>
                        <div class="metric-label">Áã¨Á´ãËÆøÂÆ¢ (vs ${comparisonPeriod})</div>
                    </div>
                </div>

                <div style="text-align: left;">
                    ${generateTrendChart()}
                </div>

                <div class="chart-title" style="text-align: left;">Á±ªÂà´Ë°®Áé∞ÂØπÊØî</div>
                <div class="bar-chart" style="justify-content: flex-start; height: 180px; gap: 15px;">
                    <div class="bar" style="height: ${barData.current}%;">
                        <div class="bar-value" style="font-size: 12px; font-weight: bold; color: #2c3e50;">${barData.current}%</div>
                        <div class="bar-label" style="font-size: 11px; color: #34495e; margin-top: 8px;">${selectedCategories[0] || 'Á±ªÂà´1'}</div>
                    </div>
                    <div class="bar" style="height: ${barData.comparison}%;">
                        <div class="bar-value" style="font-size: 12px; font-weight: bold; color: #2c3e50;">${barData.comparison}%</div>
                        <div class="bar-label" style="font-size: 11px; color: #34495e; margin-top: 8px;">ÂØπÊØîÁ±ªÂà´</div>
                    </div>
                    <div class="bar" style="height: ${barData.industry}%;">
                        <div class="bar-value" style="font-size: 12px; font-weight: bold; color: #2c3e50;">${barData.industry}%</div>
                        <div class="bar-label" style="font-size: 11px; color: #34495e; margin-top: 8px;">Ë°å‰∏öÂπ≥Âùá</div>
                    </div>
                </div>

                <div style="text-align: left;">
                    ${generateConversionChart()}
                </div>

                <div class="chart-title" style="text-align: left;">Ê∏†ÈÅìË°®Áé∞ÂàÜÂ∏É</div>
                <div style="text-align: left;">
                    ${generatePieChart()}
                </div>

                <div class="voice-of-seller">
                    <div class="voice-title">üó£Ô∏è ÂçñÂÆ∂ÂøÉÂ£∞</div>
                    ${voiceFeedback}
                </div>
                <div class="insight-box">
                    <div class="insight-title">üìä Voice of Seller Ê¥ûÂØü</div>
                    ${getVoiceInsight()}
                </div>
            `;
            addMessage(dashboard, 'bot');
        }

        function generateTrendChart() {
            const timePeriod = currentTimePeriod;
            let dataPoints = [];
            let dates = [];
            const today = new Date('2024-08-27');

            // ÁîüÊàêÂü∫‰∫éÈÄâÊã©Êó∂Èó¥ÊÆµÁöÑÊó•ÊúüÂíåÊï∞ÊçÆ
            if (timePeriod === 'Last 7 days') {
                for (let i = 6; i >= 0; i--) {
                    const date = new Date(today);
                    date.setDate(today.getDate() - i);
                    dates.push(date.toLocaleDateString('zh-CN', {month: '2-digit', day: '2-digit'}));
                    dataPoints.push(Math.floor(60 + Math.random() * 40));
                }
            } else if (timePeriod === 'Last 30 days') {
                // ÁîüÊàêËøáÂéª30Â§©ÁöÑÊï∞ÊçÆÔºàÊØèÂë®ÊòæÁ§∫‰∏Ä‰∏™ÁÇπÔºâ
                for (let i = 4; i > 0; i--) {
                    for (let j = 0; j < 7; j++) {
                        const date = new Date(today);
                        date.setDate(today.getDate() - ((i * 7) - j));
                        if (j === 3) { // ÊØèÂë®‰∏≠Èó¥ÊòæÁ§∫‰∏Ä‰∏™Êó•Êúü
                            dates.push(date.toLocaleDateString('zh-CN', {month: '2-digit', day: '2-digit'}));
                            dataPoints.push(Math.floor(60 + Math.random() * 40));
                        }
                    }
                }
                // Ê∑ªÂä†ÊúÄÂêéÂá†Â§©
                dates.push(today.toLocaleDateString('zh-CN', {month: '2-digit', day: '2-digit'}));
                dataPoints.push(Math.floor(60 + Math.random() * 40));
            } else if (timePeriod === 'Last 3 months') {
                // ÊúàÂ∫¶Êï∞ÊçÆ
                dates = ['6Êúà', '7Êúà', '8Êúà'];
                dataPoints = [70, 85, 90];
            } else if (timePeriod === 'Last 6 months') {
                // ÂèåÊúàÊï∞ÊçÆ
                dates = ['3Êúà', '4Êúà', '5Êúà', '6Êúà', '7Êúà', '8Êúà'];
                dataPoints = [65, 70, 75, 80, 85, 90];
            } else {
                dates = ['Âë®Êúü1', 'Âë®Êúü2', 'Âë®Êúü3', 'Âë®Êúü4', 'Âë®Êúü5', 'Âë®Êúü6'];
                dataPoints = [70, 75, 80, 85, 90, 95];
            }

            const maxValue = Math.max(...dataPoints);
            const minValue = Math.min(...dataPoints);
            const range = maxValue - minValue;
            const padding = range * 0.2;

            // ÂàõÂª∫ÊäòÁ∫øÂõæSVG
            return `
                <div class="line-chart-container">
                    <div class="chart-title-small">Ë°®Áé∞ÊåáÊï∞Ë∂ãÂäø - ${getTimePeriodLabel()} (Êõ¥Êñ∞‰∫é: 08/27)</div>
                    <svg class="line-chart" viewBox="0 0 500 160" width="100%" height="160">
                        <!-- YËΩ¥ -->
                        <line class="chart-axis" x1="50" y1="30" x2="50" y2="130" />
                        <line class="chart-axis" x1="50" y1="130" x2="450" y2="130" />

                        <!-- Êï∞ÊçÆÁÇπËøûÁ∫ø -->
                        <polyline class="chart-line"
                            points="${dataPoints.map((value, index) => {
                                const x = 50 + (index * (400 / (dataPoints.length - 1)));
                                const y = 130 - ((value - minValue + padding) / (range + padding * 2)) * 100;
                                return `${x},${y}`;
                            }).join(' ')}"
                            stroke="#3498db"
                            stroke-width="2.5" />

                        <!-- Êï∞ÊçÆÁÇπ -->
                        ${dataPoints.map((value, index) => {
                            const x = 50 + (index * (400 / (dataPoints.length - 1)));
                            const y = 130 - ((value - minValue + padding) / (range + padding * 2)) * 100;
                            return `
                                <circle cx="${x}" cy="${y}" r="4" fill="#3498db" stroke="#fff" stroke-width="1.5" />
                                <text class="chart-value-label" x="${x}" y="${y - 12}">${value}</text>
                            `;
                        }).join('')}

                        <!-- XËΩ¥Ê†áÁ≠æ -->
                        ${dates.map((date, index) => {
                            const x = 50 + (index * (400 / (dates.length - 1)));
                            return `<text class="chart-label" x="${x}" y="145">${date}</text>`;
                        }).join('')}

                        <!-- YËΩ¥Ê†áÁ≠æ -->
                        <text class="chart-label" x="35" y="35">${maxValue}</text>
                        <text class="chart-label" x="35" y="130">${minValue}</text>
                    </svg>
                </div>
            `;
        }

        function generateConversionChart() {
            const timePeriod = currentTimePeriod;
            let dataPoints = [];
            let dates = [];
            const today = new Date('2024-08-27');

            // ÁîüÊàêÂü∫‰∫éÈÄâÊã©Êó∂Èó¥ÊÆµÁöÑÊó•ÊúüÂíåÊï∞ÊçÆ
            if (timePeriod === 'Last 7 days') {
                for (let i = 6; i >= 0; i--) {
                    const date = new Date(today);
                    date.setDate(today.getDate() - i);
                    dates.push(date.toLocaleDateString('zh-CN', {month: '2-digit', day: '2-digit'}));
                    dataPoints.push((5 + Math.random() * 4).toFixed(1));
                }
            } else if (timePeriod === 'Last 30 days') {
                // ÁîüÊàêËøáÂéª30Â§©ÁöÑÊï∞ÊçÆÔºàÊØèÂë®ÊòæÁ§∫‰∏Ä‰∏™ÁÇπÔºâ
                for (let i = 4; i > 0; i--) {
                    for (let j = 0; j < 7; j++) {
                        const date = new Date(today);
                        date.setDate(today.getDate() - ((i * 7) - j));
                        if (j === 3) { // ÊØèÂë®‰∏≠Èó¥ÊòæÁ§∫‰∏Ä‰∏™Êó•Êúü
                            dates.push(date.toLocaleDateString('zh-CN', {month: '2-digit', day: '2-digit'}));
                            dataPoints.push((5 + Math.random() * 4).toFixed(1));
                        }
                    }
                }
                // Ê∑ªÂä†ÊúÄÂêéÂá†Â§©
                dates.push(today.toLocaleDateString('zh-CN', {month: '2-digit', day: '2-digit'}));
                dataPoints.push((5 + Math.random() * 4).toFixed(1));
            } else if (timePeriod === 'Last 3 months') {
                // ÊúàÂ∫¶Êï∞ÊçÆ
                dates = ['6Êúà', '7Êúà', '8Êúà'];
                dataPoints = [6.2, 7.5, 8.3];
            } else if (timePeriod === 'Last 6 months') {
                // ÂèåÊúàÊï∞ÊçÆ
                dates = ['3Êúà', '4Êúà', '5Êúà', '6Êúà', '7Êúà', '8Êúà'];
                dataPoints = [5.5, 6.2, 6.8, 7.2, 7.8, 8.3];
            } else {
                dates = ['Âë®Êúü1', 'Âë®Êúü2', 'Âë®Êúü3', 'Âë®Êúü4', 'Âë®Êúü5', 'Âë®Êúü6'];
                dataPoints = [6.0, 6.8, 7.2, 7.6, 8.0, 8.4];
            }

            const maxValue = Math.max(...dataPoints.map(Number));
            const minValue = Math.min(...dataPoints.map(Number));
            const range = maxValue - minValue;
            const padding = range * 0.2;

            // ÂàõÂª∫ÊäòÁ∫øÂõæSVG
            return `
                <div class="line-chart-container">
                    <div class="chart-title-small">ËΩ¨ÂåñÁéáË∂ãÂäø - ${getTimePeriodLabel()}</div>
                    <svg class="line-chart" viewBox="0 0 500 160" width="100%" height="160">
                        <!-- YËΩ¥ -->
                        <line class="chart-axis" x1="50" y1="30" x2="50" y2="130" />
                        <line class="chart-axis" x1="50" y1="130" x2="450" y2="130" />

                        <!-- Êï∞ÊçÆÁÇπËøûÁ∫ø -->
                        <polyline class="chart-line"
                            points="${dataPoints.map((value, index) => {
                                const x = 50 + (index * (400 / (dataPoints.length - 1)));
                                const y = 130 - ((value - minValue + padding) / (range + padding * 2)) * 100;
                                return `${x},${y}`;
                            }).join(' ')}"
                            stroke="#27ae60"
                            stroke-width="2.5" />

                        <!-- Êï∞ÊçÆÁÇπ -->
                        ${dataPoints.map((value, index) => {
                            const x = 50 + (index * (400 / (dataPoints.length - 1)));
                            const y = 130 - ((value - minValue + padding) / (range + padding * 2)) * 100;
                            return `
                                <circle cx="${x}" cy="${y}" r="4" fill="#27ae60" stroke="#fff" stroke-width="1.5" />
                                <text class="chart-value-label" x="${x}" y="${y - 12}">${value}%</text>
                            `;
                        }).join('')}

                        <!-- XËΩ¥Ê†áÁ≠æ -->
                        ${dates.map((date, index) => {
                            const x = 50 + (index * (400 / (dates.length - 1)));
                            return `<text class="chart-label" x="${x}" y="145">${date}</text>`;
                        }).join('')}

                        <!-- YËΩ¥Ê†áÁ≠æ -->
                        <text class="chart-label" x="35" y="35">${maxValue.toFixed(1)}%</text>
                        <text class="chart-label" x="35" y="130">${minValue.toFixed(1)}%</text>
                    </svg>
                </div>
            `;
        }

        function generatePieChart() {
            const channelData = [
                {name: 'ÂæÆ‰ø°', value: 35, color: '#3498db'},
                {name: 'ÈÇÆ‰ª∂', value: 25, color: '#e74c3c'},
                {name: 'Áõ¥Êí≠', value: 15, color: '#f39c12'},
                {name: 'Â∞èÁ∫¢‰π¶', value: 10, color: '#9b59b6'},
                {name: 'ÊäñÈü≥', value: 8, color: '#1abc9c'},
                {name: 'ËßÜÈ¢ëÂè∑', value: 7, color: '#34495e'}
            ];

            // ËÆ°ÁÆóÂúÜÈî•Ê∏êÂèòÁöÑËßíÂ∫¶ÂíåÊï∞ÂÄº‰ΩçÁΩÆ
            let currentAngle = 0;
            const gradients = channelData.map(item => {
                const startAngle = currentAngle;
                const endAngle = currentAngle + (item.value / 100) * 360;
                currentAngle = endAngle;
                return `${item.color} ${startAngle}deg ${endAngle}deg`;
            }).join(', ');

            // ËÆ°ÁÆóÊï∞ÂÄºÊòæÁ§∫‰ΩçÁΩÆ
            const valuePositions = [];
            currentAngle = 0;
            channelData.forEach(item => {
                const middleAngle = currentAngle + (item.value / 100) * 180; // ÂºßÂ∫¶ÁöÑ‰∏ÄÂçä
                currentAngle += (item.value / 100) * 360;

                const radius = 60; // È•ºÂõæÂçäÂæÑ
                const x = 80 + Math.cos((middleAngle - 90) * Math.PI / 180) * radius * 0.7;
                const y = 80 + Math.sin((middleAngle - 90) * Math.PI / 180) * radius * 0.7;

                valuePositions.push({x, y, value: item.value});
            });

            return `
                <div style="display: flex; align-items: center; margin: 20px 0;">
                    <div class="pie-chart" style="background: conic-gradient(${gradients});">
                        <div class="pie-center">Ê∏†ÈÅìÂàÜÂ∏É</div>
                        ${valuePositions.map((pos, index) => `
                            <text class="pie-value" x="${pos.x}" y="${pos.y}" text-anchor="middle" alignment-baseline="middle">
                                ${pos.value}%
                            </text>
                        `).join('')}
                    </div>
                    <div style="margin-left: 25px; font-size: 12px;">
                        ${channelData.map(item => `
                            <div style="margin-bottom: 8px; display: flex; align-items: center;">
                                <span style="display: inline-block; width: 14px; height: 14px; background: ${item.color}; margin-right: 8px; border-radius: 3px;"></span>
                                <span style="color: #2c3e50; font-weight: 500;">${item.name}: ${item.value}%</span>
                            </div>
                        `).join('')}
                    </div>
                </div>
            `;
        }

        function getChannelColor(channel) {
            const colors = {
                'wechat': '#3498db',
                'email': '#e74c3c',
                'vhall_live': '#f39c12',
                'rednote': '#9b59b6',
                'douyin_video': '#1abc9c',
                'wechat_video': '#34495e'
            };
            return colors[channel] || '#95a5a6';
        }

        function getTimePeriodLabel() {
            const periodMap = {
                'Last 7 days': 'ËøáÂéª7Â§©',
                'Last 30 days': 'ËøáÂéª30Â§©',
                'Last 3 months': 'ËøáÂéª3‰∏™Êúà',
                'Last 6 months': 'ËøáÂéª6‰∏™Êúà',
                'Custom range': 'Ëá™ÂÆö‰πâÊó∂ÊÆµ'
            };
            return periodMap[currentTimePeriod] || 'ÂΩìÂâçÊó∂ÊÆµ';
        }
        
        function getCategoryMetrics() {
            const category = selectedCategories[0] || 'default';
            const categoryMetrics = {
                'branding': { ctr: 14.2, ctrTrend: 3.1, impressions: '52.8K', impressionsTrend: 18.5, openRate: 9.7, openRateTrend: -0.8, visitors: '28.3K', visitorsTrend: 12.4 },
                'seller_education': { ctr: 16.8, ctrTrend: 4.2, impressions: '38.9K', impressionsTrend: 22.1, openRate: 11.2, openRateTrend: 2.3, visitors: '31.7K', visitorsTrend: 15.8 },
                'supply_chain': { ctr: 11.5, ctrTrend: -1.2, impressions: '41.3K', impressionsTrend: 8.7, openRate: 8.1, openRateTrend: -2.1, visitors: '19.8K', visitorsTrend: 5.3 },
                'compliance': { ctr: 13.9, ctrTrend: 2.8, impressions: '29.4K', impressionsTrend: 14.2, openRate: 10.5, openRateTrend: 1.7, visitors: '22.1K', visitorsTrend: 9.6 },
                'paid_service': { ctr: 18.3, ctrTrend: 5.7, impressions: '33.2K', impressionsTrend: 25.8, openRate: 12.8, openRateTrend: 3.4, visitors: '26.9K', visitorsTrend: 18.2 },
                'marketplace': { ctr: 15.6, ctrTrend: 2.1, impressions: '47.1K', impressionsTrend: 16.3, openRate: 9.3, openRateTrend: 0.9, visitors: '35.4K', visitorsTrend: 11.7 },
                'default': { ctr: 12.8, ctrTrend: 2.3, impressions: '45.2K', impressionsTrend: 15.7, openRate: 8.9, openRateTrend: -1.2, visitors: '23.1K', visitorsTrend: 8.4 }
            };
            return categoryMetrics[category] || categoryMetrics['default'];
        }
        
        function getCategoryBarData() {
            const category = selectedCategories[0] || 'default';
            const barData = {
                'branding': { current: 88, comparison: 75, industry: 82 },
                'seller_education': { current: 92, comparison: 78, industry: 85 },
                'supply_chain': { current: 76, comparison: 82, industry: 79 },
                'compliance': { current: 84, comparison: 71, industry: 77 },
                'paid_service': { current: 95, comparison: 68, industry: 81 },
                'marketplace': { current: 89, comparison: 83, industry: 86 },
                'default': { current: 85, comparison: 72, industry: 91 }
            };
            return barData[category] || barData['default'];
        }
        
        function getComparisonPeriod() {
            const periodMap = {
                'Last 7 days': '‰∏äÂë®ÂêåÊúü',
                'Last 30 days': '‰∏äÊúàÂêåÊúü', 
                'Last 3 months': '‰∏äÂ≠£ÂêåÊúü',
                'Last 6 months': 'ÂéªÂπ¥ÂêåÊúü',
                'Custom range': '‰∏äÊúüÂêåÊúü'
            };
            return periodMap[currentTimePeriod] || '‰∏äÊúüÂêåÊúü';
        }
        
        function updateVoiceOfSeller() {
            const voiceContainer = document.getElementById('voiceOfSeller');
            const voiceFeedback = getContextualVoiceFeedback();
            const insight = getVoiceInsight();
            const timePeriodFeedback = getTimePeriodFeedback();

            if (currentChannel && currentPurpose && selectedCategories.length > 0) {
                // Show category-specific voice feedback
                voiceContainer.innerHTML = `
                    <div class="voice-title">üó£Ô∏è ÂçñÂÆ∂ÂøÉÂ£∞ - ${currentChannel.name} ¬∑ ${currentPurpose.replace('_', ' ')} ¬∑ ${selectedCategories[0].replace('_', ' ')}</div>
                    <div style="font-size: 11px; line-height: 1.4; margin-bottom: 10px; background: #f8f9fa; padding: 8px; border-radius: 4px;">
                        ${voiceFeedback}
                        ${timePeriodFeedback ? `<br><br><em style="color: #666;">${timePeriodFeedback}</em>` : ''}
                    </div>
                    ${insight ? `<div style="font-size: 10px; color: #856404; font-style: italic;">üí° ${insight}</div>` : ''}
                `;
            } else {
                // Show default voice feedback
                voiceContainer.innerHTML = `
                    <div class="voice-title">üó£Ô∏è Voice of Seller</div>
                    <div style="font-size: 11px; line-height: 1.3; margin-bottom: 10px;">
                        ${voiceFeedback}
                        ${timePeriodFeedback ? `<br><br><em style="color: #666;">${timePeriodFeedback}</em>` : ''}
                    </div>
                    ${insight ? `<div style="font-size: 10px; color: #856404; font-style: italic;">üí° ${insight}</div>` : ''}
                `;
            }
        }
        
        function getTimePeriodFeedback() {
            const feedbackMap = {
                'Last 7 days': 'ÊúÄËøë‰∏ÄÂë®ÁöÑÊï∞ÊçÆÂèòÂåñÂæàÂ§ß',
                'Last 30 days': 'Ëøô‰∏™ÊúàÁöÑË°®Áé∞ÊØî‰∏äÊúàÂ•Ω‰∫Ü‰∏çÂ∞ë',
                'Last 3 months': 'Ëøô‰∏™Â≠£Â∫¶ÁöÑÊï∞ÊçÆË∂ãÂäø‰∏çÈîô',
                'Last 6 months': 'ÂçäÂπ¥Êù•ÁöÑÊï¥‰ΩìË°®Áé∞Á®≥ÂÆö',
                'Custom range': 'Ëøô‰∏™Êó∂Èó¥ÊÆµÁöÑÊï∞ÊçÆÂæàÊúâÂèÇËÄÉ‰ª∑ÂÄº'
            };
            return feedbackMap[currentTimePeriod] || null;
        }
        
        function getContextualVoiceFeedback() {
            if (!currentChannel || !currentPurpose || selectedCategories.length === 0) {
                return "ËØ∑ÈÄâÊã©Ê∏†ÈÅì„ÄÅÁõÆÁöÑÂíåÁ±ªÂà´Êü•ÁúãÁõ∏ÂÖ≥ÂçñÂÆ∂ÂèçÈ¶à";
            }

            const channelData = voiceOfSellerData[currentChannel.id];
            if (!channelData) {
                return "ËØ•Ê∏†ÈÅìÊöÇÊó†ÂçñÂÆ∂ÂèçÈ¶àÊï∞ÊçÆ";
            }

            const purposeData = channelData[currentPurpose];
            if (!purposeData) {
                // Fallback to generic feedback if specific purpose not found
                const fallbackFeedback = [
                    `Ëøô‰∏™${currentPurpose.replace('_', ' ')}ÁõÆÁöÑÁöÑÂÜÖÂÆπÂæàÊúâÁî®`,
                    `Â∏åÊúõËÉΩÊúâÊõ¥Â§ö${currentPurpose.replace('_', ' ')}ÁöÑÂÜÖÂÆπ`,
                    `${currentPurpose.replace('_', ' ')}ÁöÑÊï∞ÊçÆËÉΩÊõ¥ËØ¶ÁªÜÂêóÔºü`
                ];
                return fallbackFeedback.map((feedback, index) => {
                    const sellerType = index === 0 ? 'Êñ∞ÊâãÂçñÂÆ∂' : index === 1 ? 'ËµÑÊ∑±ÂçñÂÆ∂' : '‰∏≠Á∫ßÂçñÂÆ∂';
                    return `üí¨ "${feedback}" - ${sellerType}`;
                }).join('<br><br>');
            }

            // Try to find feedback for the selected category
            let categoryData = null;
            for (const category of selectedCategories) {
                if (purposeData[category]) {
                    categoryData = purposeData[category];
                    break;
                }
            }

            if (!categoryData) {
                // Fallback to first available category in the purpose
                const availableCategories = Object.keys(purposeData);
                if (availableCategories.length > 0) {
                    categoryData = purposeData[availableCategories[0]];
                } else {
                    // Final fallback to generic feedback
                    const fallbackFeedback = [
                        `Ëøô‰∏™${selectedCategories[0].replace('_', ' ')}Á±ªÂà´ÁöÑÂÜÖÂÆπÂæàÊúâÁî®`,
                        `Â∏åÊúõËÉΩÊúâÊõ¥Â§ö${selectedCategories[0].replace('_', ' ')}ÁöÑÊ°à‰æã`,
                        `${selectedCategories[0].replace('_', ' ')}ÁöÑÊï∞ÊçÆËÉΩÊõ¥ËØ¶ÁªÜÂêóÔºü`
                    ];
                    return fallbackFeedback.map((feedback, index) => {
                        const sellerType = index === 0 ? 'Êñ∞ÊâãÂçñÂÆ∂' : index === 1 ? 'ËµÑÊ∑±ÂçñÂÆ∂' : '‰∏≠Á∫ßÂçñÂÆ∂';
                        return `üí¨ "${feedback}" - ${sellerType}`;
                    }).join('<br><br>');
                }
            }

            return categoryData.map((feedback, index) => {
                const sellerType = index === 0 ? 'Êñ∞ÊâãÂçñÂÆ∂' : index === 1 ? 'ËµÑÊ∑±ÂçñÂÆ∂' : '‰∏≠Á∫ßÂçñÂÆ∂';
                return `üí¨ "${feedback.text}" - ${sellerType} (${feedback.sentiment})`;
            }).join('<br><br>');
        }
        
        function getVoiceInsight() {
            if (!currentChannel) {
                return null;
            }
            
            return voiceInsights[currentChannel.id] || null;
        }

        function askQuestion(question) {
            document.getElementById('messageInput').value = question;
            sendMessage();
        }

        function sendMessage() {
            const input = document.getElementById('messageInput');
            const message = input.value.trim();
            if (!message) return;
            
            addMessage(message, 'user');
            input.value = '';
            
            // Simulate bot response
            setTimeout(() => {
                const context = currentChannel ? `Based on ${currentChannel.name} data` : 'Based on available data';
                const categories = selectedCategories.length > 0 ? ` for ${selectedCategories.join(', ')}` : '';
                addMessage(`${context}${categories}: ${generateResponse(message)}`, 'bot');
            }, 1000);
        }

        function generateResponse(question) {
            // Generate fake data based on question type
            if (question.includes('ÂÆåËØªÁéá') || question.includes('CTR')) {
                return generateCTRAnalysis();
            } else if (question.includes('ÊâìÂºÄÁéá') || question.includes('open rate')) {
                return generateOpenRateAnalysis();
            } else if (question.includes('Áõ¥Êí≠') || question.includes('live')) {
                return generateLiveAnalysis();
            } else if (question.includes('Ê†áÈ¢ò') || question.includes('title')) {
                return generateTitleAnalysis();
            } else if (question.includes('ÈÄâÂìÅË∂ãÂäø') || question.includes('product selection')) {
                return generateProductSelectionAnalysis();
            } else {
                return generateGeneralAnalysis();
            }
        }
        
        function generateCTRAnalysis() {
            const voiceFeedback = getContextualVoiceFeedback();
            const insight = getVoiceInsight();
            
            return `
                <div class="chart-title">ÂæÆ‰ø°Ê∏†ÈÅìSelectionÁ±ªÊñáÁ´†ÂÆåËØªÁéáÂàÜÊûê (ËøáÂéª3‰∏™Êúà)</div>
                <table class="metrics-table">
                    <tr><th>ÊñáÁ´†Ê†áÈ¢ò</th><th>ÂÆåËØªÁéá</th><th>ÈòÖËØªÈáè</th><th>Áî®Êà∑ÂèçÈ¶à</th></tr>
                    <tr><td>‰∫öÈ©¨ÈÄäÈÄâÂìÅÁ≠ñÁï•ÂÖ®Ëß£Êûê</td><td>78.5%</td><td>12,450</td><td>ÈùûÂ∏∏ÂÆûÁî®</td></tr>
                    <tr><td>2024Âπ¥ÁÉ≠Èó®ÂìÅÁ±ªË∂ãÂäø</td><td>76.2%</td><td>9,830</td><td>ÂÜÖÂÆπËØ¶ÁªÜ</td></tr>
                    <tr><td>Êñ∞ÊâãÈÄâÂìÅÈÅøÂùëÊåáÂçó</td><td>74.8%</td><td>15,200</td><td>Â∏ÆÂä©ÂæàÂ§ß</td></tr>
                    <tr><td>ÈÄâÂìÅÂ∑•ÂÖ∑‰ΩøÁî®ÊäÄÂ∑ß</td><td>72.1%</td><td>8,650</td><td>Êìç‰ΩúÊÄßÂº∫</td></tr>
                    <tr><td>Â∏ÇÂú∫Ë∞ÉÁ†îÊñπÊ≥ïÂàÜ‰∫´</td><td>69.3%</td><td>11,200</td><td>ÊñπÊ≥ïÂÆûÁî®</td></tr>
                </table>
                <div class="insight-box">
                    <div class="insight-title">üìä Ê∑±Â∫¶Ê¥ûÂØü</div>
                    ‚Ä¢ ÂÆûÁî®ÊÄßÂº∫ÁöÑÈÄâÂìÅÁ≠ñÁï•ÊñáÁ´†ÂÆåËØªÁéáÊõ¥È´òÔºåÂπ≥Âùá74.2%<br>
                    ‚Ä¢ Â∑•ÂÖ∑Á±ªÊïôÁ®ã‰∫íÂä®ÁéáÊØîÁêÜËÆ∫ÊñáÁ´†È´ò35%<br>
                    ‚Ä¢ ÂåóÁæéÂ∏ÇÂú∫Áõ∏ÂÖ≥ÂÜÖÂÆπÊØîÂÖ∂‰ªñÂú∞Âå∫È´ò20%ÂèÇ‰∏éÂ∫¶<br>
                    ‚Ä¢ Âë®‰∫åÂèëÂ∏ÉÁöÑÊñáÁ´†ÂÆåËØªÁéáÊØîÂë®Êú´È´ò28%
                </div>
                ${voiceFeedback ? `
                <div class="voice-of-seller">
                    <div class="voice-title">üó£Ô∏è ÂçñÂÆ∂Ê∑±Â∫¶ÂèçÈ¶à</div>
                    ${voiceFeedback}
                </div>
                ` : ''}
                ${insight ? `
                <div class="insight-box">
                    <div class="insight-title">üí° Voice of Seller Ê¥ûÂØü</div>
                    ${insight}
                </div>
                ` : ''}
            `;
        }
        
        function generateOpenRateAnalysis() {
            const voiceFeedback = getContextualVoiceFeedback();
            const insight = getVoiceInsight();
            
            return `
                <div class="chart-title">Ads DomainÂæÆ‰ø°ËÆ¢ÈòÖÂè∑ÊâìÂºÄÁéáÂØπÊØîÂàÜÊûê</div>
                <div class="bar-chart">
                    <div class="bar" style="height: 80%;"><div class="bar-value">8.2%</div><div class="bar-label">ÂìÅÁâåÂπøÂëä</div></div>
                    <div class="bar" style="height: 65%;"><div class="bar-value">6.5%</div><div class="bar-label">‰∫ßÂìÅÊé®Âπø</div></div>
                    <div class="bar" style="height: 90%;"><div class="bar-value">9.1%</div><div class="bar-label">ÊïôËÇ≤ÂÜÖÂÆπ</div></div>
                    <div class="bar" style="height: 45%;"><div class="bar-value">4.3%</div><div class="bar-label">‰øÉÈîÄÊ¥ªÂä®</div></div>
                </div>
                <div class="insight-box">
                    <div class="insight-title">üéØ Top 10 vs Last 10 CTRÂ∑ÆÂºÇÂàÜÊûê</div>
                    Top 10ÊñáÁ´†Âπ≥ÂùáCTR: 12.8% | Last 10ÊñáÁ´†Âπ≥ÂùáCTR: 3.2%<br>
                    ‰∏ªË¶ÅÂ∑ÆÂºÇÂéüÂõ†ÔºöÊ†áÈ¢òÂê∏ÂºïÂäõ„ÄÅÂèëÂ∏ÉÊó∂Èó¥„ÄÅÂÜÖÂÆπË¥®Èáè„ÄÅÁî®Êà∑ÁîªÂÉèÂåπÈÖçÂ∫¶
                </div>
                ${voiceFeedback ? `
                <div class="voice-of-seller">
                    <div class="voice-title">üó£Ô∏è Áõ∏ÂÖ≥ÂçñÂÆ∂ÂèçÈ¶à</div>
                    ${voiceFeedback}
                </div>
                ` : ''}
                ${insight ? `
                <div class="insight-box">
                    <div class="insight-title">üí° Voice of Seller Ê¥ûÂØü</div>
                    ${insight}
                </div>
                ` : ''}
            `;
        }
        
        function generateLiveAnalysis() {
            return `
                <div class="chart-title">‰æõÂ∫îÈìæÁõ¥Êí≠Á≥ªÂàó - ÂçñÂÆ∂ÂèçÈ¶àÂàÜÊûê</div>
                <div class="insight-box">
                    <div class="insight-title">üî• ÂçñÂÆ∂ÂèçÈ¶àÊúÄÂ•ΩÁöÑ5‰∏™‰∏ªÈ¢ò</div>
                    1. Áâ©ÊµÅÊàêÊú¨‰ºòÂåñÁ≠ñÁï• (Êª°ÊÑèÂ∫¶: 94%)<br>
                    2. Â∫ìÂ≠òÁÆ°ÁêÜÊúÄ‰Ω≥ÂÆûË∑µ (Êª°ÊÑèÂ∫¶: 91%)<br>
                    3. ‰æõÂ∫îÂïÜË∞àÂà§ÊäÄÂ∑ß (Êª°ÊÑèÂ∫¶: 89%)<br>
                    4. Ë∑®Â¢ÉÁâ©ÊµÅËß£ÂÜ≥ÊñπÊ°à (Êª°ÊÑèÂ∫¶: 87%)<br>
                    5. ‰ªìÂÇ®ÊïàÁéáÊèêÂçáÊñπÊ≥ï (Êª°ÊÑèÂ∫¶: 85%)
                </div>
                <div class="insight-box">
                    <div class="insight-title">‚ùì ÂçñÂÆ∂ÊúÄÂÖ≥ÂøÉÁöÑ10‰∏™ÈóÆÈ¢ò</div>
                    1. Â¶Ç‰ΩïÈôç‰ΩéFBAË¥πÁî®Ôºü<br>
                    2. Êµ∑Â§ñ‰ªìvs FBAÂ¶Ç‰ΩïÈÄâÊã©Ôºü<br>
                    3. Â∫ìÂ≠òÂë®ËΩ¨ÁéáÂ¶Ç‰ΩïÊèêÂçáÔºü<br>
                    4. ‰æõÂ∫îÂïÜË¥®ÈáèÂ¶Ç‰ΩïÊääÊéßÔºü<br>
                    5. Áâ©ÊµÅÊó∂ÊïàÂ¶Ç‰Ωï‰øùËØÅÔºü<br>
                    6. ÈÄÄË¥ßÂ§ÑÁêÜÊúÄ‰Ω≥ÊñπÊ°àÔºü<br>
                    7. Â§öÊ∏†ÈÅìÂ∫ìÂ≠òÂ¶Ç‰ΩïÁªü‰∏ÄÔºü<br>
                    8. Â≠£ËäÇÊÄßÂ§áË¥ßÁ≠ñÁï•Ôºü<br>
                    9. ‰æõÂ∫îÈìæÈ£éÈô©Â¶Ç‰ΩïËßÑÈÅøÔºü<br>
                    10. ÊàêÊú¨Ê†∏ÁÆóÊñπÊ≥ï‰ºòÂåñÔºü
                </div>
            `;
        }
        
        function generateTitleAnalysis() {
            return `
                <div class="chart-title">Ê†áÈ¢òCTRÈ¢ÑÊµãÂàÜÊûê</div>
                <table class="metrics-table">
                    <tr><th>Ê∏†ÈÅì</th><th>È¢ÑÊµãCTR</th><th>ÁΩÆ‰ø°Â∫¶</th><th>Âª∫ËÆÆ</th></tr>
                    <tr><td>ÂæÆ‰ø°ËÆ¢ÈòÖÂè∑</td><td>7.8%</td><td>85%</td><td>Ê†áÈ¢òÈïøÂ∫¶ÈÄÇ‰∏≠</td></tr>
                    <tr><td>EmailËê•ÈîÄ</td><td>12.3%</td><td>78%</td><td>Ê∑ªÂä†Á¥ßËø´ÊÑüËØçÊ±á</td></tr>
                    <tr><td>Â∞èÁ∫¢‰π¶</td><td>15.6%</td><td>82%</td><td>Â¢ûÂä†Ë°®ÊÉÖÁ¨¶Âè∑</td></tr>
                </table>
                <div class="insight-box">
                    <div class="insight-title">üí° ‰ºòÂåñÂª∫ËÆÆ</div>
                    Âü∫‰∫éÂéÜÂè≤Êï∞ÊçÆÂàÜÊûêÔºåÂª∫ËÆÆÂú®Ê†áÈ¢ò‰∏≠Âä†ÂÖ•"Áã¨ÂÆ∂"„ÄÅ"ÈôêÊó∂"Á≠âÂÖ≥ÈîÆËØçÔºåÈ¢ÑËÆ°ÂèØÊèêÂçáCTR 15-20%„ÄÇ
                </div>
            `;
        }
        
        function generateGeneralAnalysis() {
            return `
                <div class="chart-title">Ëê•ÈîÄÊï∞ÊçÆÁªºÂêàÂàÜÊûê</div>
                <div class="bar-chart">
                    <div class="bar" style="height: 85%;"><div class="bar-value">85%</div><div class="bar-label">ÂæÆ‰ø°</div></div>
                    <div class="bar" style="height: 72%;"><div class="bar-value">72%</div><div class="bar-label">ÈÇÆ‰ª∂</div></div>
                    <div class="bar" style="height: 68%;"><div class="bar-value">68%</div><div class="bar-label">Áõ¥Êí≠</div></div>
                    <div class="bar" style="height: 91%;"><div class="bar-value">91%</div><div class="bar-label">Â∞èÁ∫¢‰π¶</div></div>
                </div>
                <div class="insight-box">
                    <div class="insight-title">üìà ÂÖ≥ÈîÆÂèëÁé∞</div>
                    Â∞èÁ∫¢‰π¶Ê∏†ÈÅìË°®Áé∞ÊúÄ‰Ω≥ÔºåÁî®Êà∑ÂèÇ‰∏éÂ∫¶È´òËææ91%„ÄÇÂª∫ËÆÆÂ¢ûÂä†ËØ•Ê∏†ÈÅìÊäïÂÖ•Ôºå‰ºòÂåñÂÜÖÂÆπÁ≠ñÁï•„ÄÇ
                </div>
            `;
        }

        function generateProductSelectionAnalysis() {
            const voiceFeedback = getContextualVoiceFeedback();
            const insight = getVoiceInsight();

            return `
                <div class="chart-title">ÈÄâÂìÅË∂ãÂäøÊñáÁ´†ÂéÜÂè≤Ë°®Áé∞ÂàÜÊûê (ÂæÆ‰ø°Ê∏†ÈÅì)</div>
                <div class="bar-chart">
                    <div class="bar" style="height: 85%;"><div class="bar-value">85%</div><div class="bar-label">ÂÆåËØªÁéá</div></div>
                    <div class="bar" style="height: 78%;"><div class="bar-value">78%</div><div class="bar-label">ÂàÜ‰∫´Áéá</div></div>
                    <div class="bar" style="height: 92%;"><div class="bar-value">92%</div><div class="bar-label">ÂÆûÁî®ËØÑÂàÜ</div></div>
                </div>
                <div class="insight-box">
                    <div class="insight-title">üìä ÂéÜÂè≤Ë°®Áé∞ÊúÄ‰Ω≥ÁöÑÊñáÁ´†Á±ªÂûã</div>
                    ‚Ä¢ Êï∞ÊçÆÂàÜÊûêÁ±ª: Â∏ÇÂú∫Ë∂ãÂäø+ÂÖ∑‰ΩìÊï∞ÊçÆÊîØÊíë (CTR: 12.5%)<br>
                    ‚Ä¢ Ê°à‰æãÁ†îÁ©∂Á±ª: ÊàêÂäüÂçñÂÆ∂ÈÄâÂìÅÊïÖ‰∫ã (CTR: 11.8%)<br>
                    ‚Ä¢ Â∑•ÂÖ∑ÊïôÁ®ãÁ±ª: ÈÄâÂìÅÂ∑•ÂÖ∑‰ΩøÁî®ÊåáÂçó (CTR: 10.9%)<br>
                    ‚Ä¢ Â≠£ËäÇÊÄßÈÄâÂìÅ: ËäÇÂÅáÊó•/Â≠£ËäÇ‰∫ßÂìÅÊé®Ëçê (CTR: 9.7%)
                </div>
                <div class="insight-box">
                    <div class="insight-title">üí° ÂÜÖÂÆπÂª∫ËÆÆ</div>
                    ‚Ä¢ Ê†áÈ¢òÂåÖÂê´ÂÖ∑‰ΩìÊï∞ÊçÆ: "2024Âπ¥Q1Â¢ûÈïøÊúÄÂø´ÁöÑ5‰∏™ÂìÅÁ±ªÔºåÂêåÊØîÂ¢ûÈïø67%"<br>
                    ‚Ä¢ ÁªìÂêà‰∫öÈ©¨ÈÄäÂÆòÊñπÊï∞ÊçÆÂ¢ûÂä†ÂèØ‰ø°Â∫¶<br>
                    ‚Ä¢ Ê∑ªÂä†ÂÆûÁî®Â∑•ÂÖ∑Êé®ËçêÂíåÊìç‰ΩúÊåáÂçó<br>
                    ‚Ä¢ ÂåÖÂê´ÁúüÂÆûÂçñÂÆ∂Ê°à‰æãÂíåÊàêÊûúÂ±ïÁ§∫<br>
                    ‚Ä¢ ÊúÄ‰Ω≥ÂèëÂ∏ÉÊó∂Èó¥: Âë®‰∫å/Âë®Âõõ‰∏äÂçà10-11ÁÇπ
                </div>
                <div class="voice-of-seller">
                    <div class="voice-title">üó£Ô∏è ÂçñÂÆ∂ÂØπÈÄâÂìÅÂÜÖÂÆπÁöÑÂèçÈ¶à</div>
                    <div style="font-size: 11px; line-height: 1.4;">
                        üí¨ "ÈÄâÂìÅÊï∞ÊçÆÂæàÊúâÁî®Ôºå‰ΩÜÂ∏åÊúõËÉΩÊõ¥ÂèäÊó∂Êõ¥Êñ∞" - ËµÑÊ∑±ÂçñÂÆ∂<br><br>
                        üí¨ "Ê°à‰æãÁ†îÁ©∂ÊúÄÊúâ‰ª∑ÂÄºÔºåÊÉ≥Áü•ÈÅìÂÖ∑‰ΩìÊìç‰ΩúÊ≠•È™§" - ‰∏≠Á∫ßÂçñÂÆ∂<br><br>
                        üí¨ "Â≠£ËäÇÊÄßÈÄâÂìÅÊèêÈÜíÂæàÂèäÊó∂ÔºåÂ∏ÆÊàëÊäì‰Ωè‰∫ÜÈîÄÂîÆÊú∫‰ºö" - Êñ∞ÊâãÂçñÂÆ∂<br><br>
                        üí¨ "Â∏åÊúõÊúâÊõ¥Â§öÂ∞è‰ºóÂìÅÁ±ªÁöÑÊï∞ÊçÆÂàÜÊûê" - ËµÑÊ∑±ÂçñÂÆ∂
                    </div>
                </div>
                ${insight ? `
                <div class="insight-box">
                    <div class="insight-title">üí° Voice of Seller Ê¥ûÂØü</div>
                    ${insight}
                </div>
                ` : ''}
            `;
        }

        function addMessage(text, sender) {
            const messagesContainer = document.getElementById('chatMessages');
            const messageDiv = document.createElement('div');
            messageDiv.className = `message ${sender}`;
            
            if (sender === 'bot' && text.includes('<')) {
                messageDiv.innerHTML = text;
            } else {
                messageDiv.textContent = text;
            }
            
            messagesContainer.appendChild(messageDiv);
            messagesContainer.scrollTop = messagesContainer.scrollHeight;
            
            // Remove welcome message if it exists
            const welcome = messagesContainer.querySelector('.welcome-message');
            if (welcome) welcome.remove();
        }

        // Event listeners
        document.getElementById('channelSelect').addEventListener('change', selectChannel);
        document.getElementById('purposeSelect').addEventListener('change', updateCategories);
        document.getElementById('timePeriod').addEventListener('change', function() {
            currentTimePeriod = this.value;
            updateVoiceOfSeller();
            updateDataTimestamp();
        });
        document.getElementById('messageInput').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') sendMessage();
        });
        
        function updateDataTimestamp() {
            const now = new Date();
            const month = String(now.getMonth() + 1).padStart(2, '0');
            const day = String(now.getDate()).padStart(2, '0');
            document.getElementById('dataUpdate').textContent = `Data updated: ${month}/${day}`;
        }

        // Initialize on load
        initializeUI();
        updateDataTimestamp();
    </script>
</body>
</html>